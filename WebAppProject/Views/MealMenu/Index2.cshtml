@using WebAppProject.ViewModels
@model MealMenuVM

<link rel="stylesheet" href="~/css/MealMenuIndex.css" asp-append-version="true" />

<div class="register_meal">
    <h5>Đăng ký cơm trưa</h5>
    <p> Mã ID:  @Model.user_id</p>
    <p> Nhân viên : @Model.user_name</p>
    <form asp-action="Index2" method="post">
        <i class="far fa-calendar-alt"></i> &nbsp;
        <div class="form-check form-check-inline">
            <input asp-for="Monday" class="form-check-input" type="checkbox" id="monday" value="true">
            <label class="form-check-label" for="inlineCheckbox1">Thứ 2</label>
        </div>
        <div class="form-check form-check-inline">
            <input asp-for="Tuesday" class="form-check-input" type="checkbox" id="tuesday" value="true">
            <label class="form-check-label" for="inlineCheckbox2">Thứ 3</label>
        </div>
        <div class="form-check form-check-inline">
            <input asp-for="Wednesday" class="form-check-input" type="checkbox" id="wednesday" value="true">
            <label class="form-check-label" for="inlineCheckbox1">Thứ 4</label>
        </div>
        <div class="form-check form-check-inline">
            <input asp-for="Thursday" class="form-check-input" type="checkbox" id="thursday" value="true">
            <label class="form-check-label" for="inlineCheckbox2">Thứ 5</label>
        </div>
        <div class="form-check form-check-inline">
            <input asp-for="Friday" class="form-check-input" type="checkbox" id="friday" value="true">
            <label class="form-check-label" for="inlineCheckbox1">Thứ 6</label>
        </div>
        <div class="form-check-inline">
            <input type="submit" value="Lưu" class="btn btn-primary" id="submit_button" onclick="inform_display()" />
        </div>
    </form>
    <div class="date_week">
        @{
            DateTime today = DateTime.Now.Date;
            var get_day = ((int)today.DayOfWeek - (int)DayOfWeek.Monday + 7) % 7;
            DateTime monday_this_week = today.AddDays(-get_day);
            var sunday_this_week = monday_this_week.AddDays(6);
            var monday_next_week = monday_this_week.AddDays(7);
            var sunday_next_week = monday_next_week.AddDays(6);
        }
        <select class="form-select" id="week_selector">
            <option value="next_week">@monday_next_week.ToString("dd/MM/yyyy") đến @sunday_next_week.ToString("dd/MM/yyyy")</option>
            <option value="this_week">@monday_this_week.ToString("dd/MM/yyyy") đến @sunday_this_week.ToString("dd/MM/yyyy")</option>
        </select>
    </div>
</div>

<div class="display_data">
    <table class="table table-striped" id="meal_table">
        <thead>
            <tr id="table_day">
                <th></th>
                <th>Thứ 2</th>
                <th>Thứ 3</th>
                <th>Thứ 4</th>
                <th>Thứ 5</th>
                <th>Thứ 6</th>
                <th>Thứ 7</th>
            </tr>
        </thead>
        <tbody>
            <tr class="table_meal">
                <td style="font-weight:700; color: red;">Món Chính</td>
                <td>
                    @foreach (var meal in Model.MainMeal)
                    {
                        if (meal.Day == "Thứ 2")
                        {
                            <p>@meal.Name</p>
                        }
                    }
                </td>
                <td>
                    @foreach (var meal in Model.MainMeal)
                    {
                        if (meal.Day == "Thứ 3")
                        {
                            <p>@meal.Name</p>
                        }
                    }
                </td>
                <td>
                    @foreach (var meal in Model.MainMeal)
                    {
                        if (meal.Day == "Thứ 4")
                        {
                            <p>@meal.Name</p>
                        }
                    }
                </td>
                <td>
                    @foreach (var meal in Model.MainMeal)
                    {
                        if (meal.Day == "Thứ 5")
                        {
                            <p>@meal.Name</p>
                        }
                    }
                </td>
                <td>
                    @foreach (var meal in Model.MainMeal)
                    {
                        if (meal.Day == "Thứ 6")
                        {
                            <p>@meal.Name</p>
                        }
                    }
                </td>
                <td>
                    @foreach (var meal in Model.MainMeal)
                    {
                        if (meal.Day == "Thứ 7")
                        {
                            <p>@meal.Name</p>
                        }
                    }
                </td>
            </tr>
            <tr class="table_meal">
                <td style="font-weight:700; color: green;">Món phụ</td>
                <td>
                    @foreach (var meal in Model.SideMeal)
                    {
                        if (meal.Day == "Thứ 2")
                        {
                            <p>@meal.Name</p>
                        }
                    }
                </td>
                <td>
                    @foreach (var meal in Model.SideMeal)
                    {
                        if (meal.Day == "Thứ 3")
                        {
                            <p>@meal.Name</p>
                        }
                    }
                </td>
                <td>
                    @foreach (var meal in Model.SideMeal)
                    {
                        if (meal.Day == "Thứ 4")
                        {
                            <p>@meal.Name</p>
                        }
                    }
                </td>
                <td>
                    @foreach (var meal in Model.SideMeal)
                    {
                        if (meal.Day == "Thứ 5")
                        {
                            <p>@meal.Name</p>
                        }
                    }
                </td>
                <td>
                    @foreach (var meal in Model.SideMeal)
                    {
                        if (meal.Day == "Thứ 6")
                        {
                            <p>@meal.Name</p>
                        }
                    }
                </td>
                <td>
                    @foreach (var meal in Model.SideMeal)
                    {
                        if (meal.Day == "Thứ 7")
                        {
                            <p>@meal.Name</p>
                        }
                    }
                </td>
            </tr>
            <tr class="table_meal">
                <td style="font-weight:700; color:orange;">Món cơ bản</td>
                <td>
                    @foreach (var meal in Model.BasicMeal)
                    {
                        if (meal.Day == "Thứ 2")
                        {
                            <p>@meal.Name</p>
                        }
                    }
                </td>
                <td>
                    @foreach (var meal in Model.BasicMeal)
                    {
                        if (meal.Day == "Thứ 3")
                        {
                            <p>@meal.Name</p>
                        }
                    }
                </td>
                <td>
                    @foreach (var meal in Model.BasicMeal)
                    {
                        if (meal.Day == "Thứ 4")
                        {
                            <p>@meal.Name</p>
                        }
                    }
                </td>
                <td>
                    @foreach (var meal in Model.BasicMeal)
                    {
                        if (meal.Day == "Thứ 5")
                        {
                            <p>@meal.Name</p>
                        }
                    }
                </td>
                <td>
                    @foreach (var meal in Model.BasicMeal)
                    {
                        if (meal.Day == "Thứ 6")
                        {
                            <p>@meal.Name</p>
                        }
                    }
                </td>
                <td>
                    @foreach (var meal in Model.BasicMeal)
                    {
                        if (meal.Day == "Thứ 7")
                        {
                            <p>@meal.Name</p>
                        }
                    }
                </td>
            </tr>
        </tbody>
    </table>
</div>


<script>
    
    function inform_display() {
        alert("Đăng ký cơm thành công !");
    }

    document.getElementById("week_selector").addEventListener("change", function () {
        var select_value = this.value;
        var url = "";

        if (select_value == "this_week") {
            url = "@Url.Action("Index", "MealMenu")";
        }
        else if ( select_value == "next_week") {
            url = "@Url.Action("Index2", "MealMenu")";
        }
        window.location.href = url;
    });

</script>